image: registry.gitlab.com/gluttton/munkres-cpp
stages:
    - test
    - full


test_job:
    stage: test
    before_script:
        #- git checkout devel
        - BUILD_DIR=`pwd`/build
        - mkdir -p ${BUILD_DIR}
        - cd ${BUILD_DIR}
        - cmake -DCMAKE_BUILD_TYPE=Debug -DMUNKRESCPP_DEVEL_MODE=ON ${BUILD_DIR}/..
    script:
        - make tests
        - cd ${BUILD_DIR}/tests && ./munkrestest > /dev/null
        - cd ${BUILD_DIR}
        - gcovr --exclude 'tests' --exclude 'build' -r ..


full_job:
    stage: full
    before_script:
        #- git checkout devel
        - BUILD_DIR=`pwd`/build
        - mkdir -p ${BUILD_DIR}
        - cd ${BUILD_DIR}
        - cmake -DCMAKE_BUILD_TYPE=Debug -DMUNKRESCPP_DEVEL_MODE=ON ${BUILD_DIR}/..
    script:
        - make examples
        - make benchmarks
